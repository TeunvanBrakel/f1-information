{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/teunv/OneDrive/Documenten/Fontys/Semester 3/Individueel/f1-information/Front-end/Admin-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nlet LoginComponent = class LoginComponent {\n  constructor(authService, tokenStorage) {\n    this.authService = authService;\n    this.tokenStorage = tokenStorage;\n    this.form = {\n      username: null,\n      password: null\n    };\n    this.isLoggedIn = false;\n    this.isLoginFailed = false;\n    this.errorMessage = \"\";\n    this.roles = [];\n    this.failedLogin = 0;\n    this.fails = \"\";\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      if (_this.tokenStorage.getToken()) {\n        _this.isLoggedIn = true;\n        _this.roles = _this.tokenStorage.getUser();\n      }\n\n      if (localStorage.getItem(\"fails\") != null) {\n        _this.fails = window.localStorage.getItem(\"fails\");\n\n        if (_this.fails == \"1\") {\n          _this.failedLogin = 1;\n        } else if (_this.fails == \"2\") {\n          _this.failedLogin = 2;\n        } else if (_this.fails == \"3\") {\n          _this.failedLogin = 3;\n        } else if (_this.fails == \"4\") {\n          _this.failedLogin = 4;\n        }\n      }\n    })();\n  }\n\n  onSubmit() {\n    var _this2 = this;\n\n    const {\n      username,\n      password\n    } = this.form; //console.log(this.authService.login(username, password));\n\n    this.authService.login(username, password).subscribe( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (data) {\n        console.log(data.text);\n\n        _this2.tokenStorage.saveToken(data.accessToken);\n\n        _this2.tokenStorage.saveUser(data);\n\n        console.log(_this2.tokenStorage);\n        _this2.isLoginFailed = false;\n        _this2.isLoggedIn = true;\n\n        _this2.tokenStorage.saveUser(username);\n\n        _this2.roles = _this2.tokenStorage.getUser();\n\n        _this2.reloadPage();\n      });\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }(), /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator(function* (err) {\n        _this2.errorMessage = err.title;\n        _this2.failedLogin = _this2.failedLogin + 1;\n        localStorage.setItem(\"fails\", _this2.failedLogin.toLocaleString());\n        _this2.fails = window.localStorage.getItem(\"fails\");\n        _this2.isLoginFailed = true;\n\n        if (_this2.fails == \"5\") {\n          yield new Promise(f => setTimeout(f, 60000));\n          _this2.failedLogin = 0;\n          localStorage.setItem(\"fails\", _this2.failedLogin.toLocaleString());\n          _this2.fails = window.localStorage.getItem(\"fails\");\n        }\n      });\n\n      return function (_x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }());\n  }\n\n  reloadPage() {\n    window.location.reload();\n  }\n\n};\nLoginComponent = __decorate([Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.css']\n})], LoginComponent);\nexport { LoginComponent };","map":{"version":3,"sources":["C:/Users/teunv/OneDrive/Documenten/Fontys/Semester 3/Individueel/f1-information/Front-end/Admin-app/src/app/login/login.component.ts"],"names":["__decorate","Component","LoginComponent","constructor","authService","tokenStorage","form","username","password","isLoggedIn","isLoginFailed","errorMessage","roles","failedLogin","fails","ngOnInit","getToken","getUser","localStorage","getItem","window","onSubmit","login","subscribe","data","console","log","text","saveToken","accessToken","saveUser","reloadPage","err","title","setItem","toLocaleString","Promise","f","setTimeout","location","reload","selector","templateUrl","styleUrls"],"mappings":"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","sourcesContent":["import { __decorate } from \"tslib\";\r\nimport { Component } from '@angular/core';\r\nlet LoginComponent = class LoginComponent {\r\n    constructor(authService, tokenStorage) {\r\n        this.authService = authService;\r\n        this.tokenStorage = tokenStorage;\r\n        this.form = {\r\n            username: null,\r\n            password: null,\r\n        };\r\n        this.isLoggedIn = false;\r\n        this.isLoginFailed = false;\r\n        this.errorMessage = \"\";\r\n        this.roles = [];\r\n        this.failedLogin = 0;\r\n        this.fails = \"\";\r\n    }\r\n    async ngOnInit() {\r\n        if (this.tokenStorage.getToken()) {\r\n            this.isLoggedIn = true;\r\n            this.roles = this.tokenStorage.getUser();\r\n        }\r\n        if (localStorage.getItem(\"fails\") != null) {\r\n            this.fails = window.localStorage.getItem(\"fails\");\r\n            if (this.fails == \"1\") {\r\n                this.failedLogin = 1;\r\n            }\r\n            else if (this.fails == \"2\") {\r\n                this.failedLogin = 2;\r\n            }\r\n            else if (this.fails == \"3\") {\r\n                this.failedLogin = 3;\r\n            }\r\n            else if (this.fails == \"4\") {\r\n                this.failedLogin = 4;\r\n            }\r\n        }\r\n    }\r\n    onSubmit() {\r\n        const { username, password } = this.form;\r\n        //console.log(this.authService.login(username, password));\r\n        this.authService.login(username, password).subscribe(async (data) => {\r\n            console.log(data.text);\r\n            this.tokenStorage.saveToken(data.accessToken);\r\n            this.tokenStorage.saveUser(data);\r\n            console.log(this.tokenStorage);\r\n            this.isLoginFailed = false;\r\n            this.isLoggedIn = true;\r\n            this.tokenStorage.saveUser(username);\r\n            this.roles = this.tokenStorage.getUser();\r\n            this.reloadPage();\r\n        }, async (err) => {\r\n            this.errorMessage = err.title;\r\n            this.failedLogin = this.failedLogin + 1;\r\n            localStorage.setItem(\"fails\", this.failedLogin.toLocaleString());\r\n            this.fails = window.localStorage.getItem(\"fails\");\r\n            this.isLoginFailed = true;\r\n            if (this.fails == \"5\") {\r\n                await new Promise(f => setTimeout(f, 60000));\r\n                this.failedLogin = 0;\r\n                localStorage.setItem(\"fails\", this.failedLogin.toLocaleString());\r\n                this.fails = window.localStorage.getItem(\"fails\");\r\n            }\r\n        });\r\n    }\r\n    reloadPage() {\r\n        window.location.reload();\r\n    }\r\n};\r\nLoginComponent = __decorate([\r\n    Component({\r\n        selector: 'app-login',\r\n        templateUrl: './login.component.html',\r\n        styleUrls: ['./login.component.css']\r\n    })\r\n], LoginComponent);\r\nexport { LoginComponent };\r\n"]},"metadata":{},"sourceType":"module"}